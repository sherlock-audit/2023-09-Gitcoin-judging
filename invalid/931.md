Suave Crimson Peacock

medium

# `Allo::fundPool()` will not be able to fund a pool if `percentFee` is set to `1e18`

User will not be able to fund a pool if the percent fee is equal to `1e18` (100 percent). All of the funds will be spent to pay the `percentFee`.

## Vulnerability Detail

This check in `Allo::updatePercentFee()` (given below) doesn't check if the `percentFee` is set to `1e18` that is 100 percent of the funds. 

https://github.com/sherlock-audit/2023-09-Gitcoin/blob/main/allo-v2/contracts/core/Allo.sol#L576-L576

That means if it is set to `1e18` then all of the funds will be spent to pay the fee and `0` will be transferred to the pool (As `_trasnferAmount` doesn't revert on 0 value transfer). This should never be the case. The `percentFee` should always be less than `1e18`. 

To fix that someone would have to call the `_updatePercentFee` again with correct value. Otherwise everyone will spent their whole amounts.

## Impact

User's will not be able to fund a pool or we can say `0` amount will be transferred to the pool and they will have to spent their all amount on the `percentFee`.

## Code Snippet
__updatePercentFee_
https://github.com/sherlock-audit/2023-09-Gitcoin/blob/main/allo-v2/contracts/core/Allo.sol#L575-L581

__fundPool_
https://github.com/sherlock-audit/2023-09-Gitcoin/blob/main/allo-v2/contracts/core/Allo.sol#L502-L520


#### code for POC
```Javascript

    function test_UserWillNeverBeAbleToFundThePoolIfPercentFeeIsOneHundredPercent() public {
        vm.prank(pool_admin());
        // owner creates a pool with ETH as a token
        uint256 poolId = allo().createPoolWithCustomStrategy{value: 0}(
            poolProfile_id(), strategy, "0x", NATIVE, 0, metadata, pool_managers()
        );

        uint256 amountToFund = 2 ether;
        uint256 baseFee = 1 ether;
        uint256 percentageFee = 1 ether;
        uint256 percentageFeeForTheAmount = amountToFund * percentageFee / 1e18;
        uint256 alloBalanceBefore = address(allo()).balance;
        uint256 userBalance = 3 ether;
        uint256 extraUserBalance = 1 ether;

        allo().updateBaseFee(baseFee);
        allo().updatePercentFee(percentageFee);

        // creating user who wants to send the amount
        address user = makeAddr("user");

        // sending eth to the user
        vm.deal(user, userBalance + extraUserBalance);

        // sending eth to the pool
        // assumption: user send more as value than the amount to fund
        vm.prank(user);
        allo().fundPool{value: userBalance + 10000 wei}(poolId, amountToFund);

        // balance after the pool is funded
        uint256 alloBalanceAfter = address(allo()).balance;

        // should be zero
        assertEq(address(strategy).balance, 0);

        // The allo must have the extra amount
        assertEq(alloBalanceAfter - alloBalanceBefore, userBalance - amountToFund + 10000 wei);
    }

```


<details>
<summary>output</summary>

```bash
[PASS] test_UserWillNeverBeAbleToFundThePoolIfPercentFeeIsOneHundredPercent() (gas: 458555)
Logs:
  Sending 1 to the strategy for initialization
  deploying with poolId 1
  1
  Transfering 2000000000000000000 to 0x11CDD8c4b40352E593942e66b1ccA5DC28E391B4
  Transfering 0 to 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a

Traces:
  [8537687] AlloTest::setUp() 
    ├─ [2129265] → new Registry@0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f
    │   └─ ← 10635 bytes of code
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← registry_owner: [0x258d92158E12b867DEb88eff01D1496334c77576]
    ├─ [0] VM::label(registry_owner: [0x258d92158E12b867DEb88eff01D1496334c77576], registry_owner)
    │   └─ ← ()
    ├─ [48636] Registry::initialize(registry_owner: [0x258d92158E12b867DEb88eff01D1496334c77576])
    │   ├─ emit RoleGranted(role: 0x815b5a78dc333d344c7df9da23c04dbd432015cc701876ddb9ffe850e6882747, account: registry_owner: [0x258d92158E12b867DEb88eff01D1496334c77576], sender: AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─ emit Initialized(version: 1)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]
    ├─ [0] VM::label(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], pool_admin)
    │   └─ ← ()
    ├─ [0] VM::prank(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]
    ├─ [0] VM::label(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], pool_admin)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107]
    ├─ [0] VM::label(pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107], pool_manager1)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f]
    ├─ [0] VM::label(pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f], pool_manager2)
    │   └─ ← ()
    ├─ [522450] Registry::createProfile(0, Pool Profile 1, (1, PoolProfile1), pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], [0x05800FAD118693c398e4E1ceFBb1FAC54537b107, 0xF49D32655a289163297342376EA91F6434cff60f])
    │   ├─ [1617] → new <Unknown>@0xaD92F0f1b8BcC455322094820e4a1BC90875c5A1
    │   │   └─ ← 8 bytes of code
    │   ├─ [266159] 0xaD92F0f1b8BcC455322094820e4a1BC90875c5A1::60c06040(5234801561001057600080fd5b5060405161051438038061051483398101604081905261002f9161003b565b3360805260a052610054565b60006020828403121561004d57600080fd5b5051919050565b60805160a05161048f610085600039600081816056015261012c015260008181609d015261015b015261048f6000f3fe6080604052600436106100385760003560e01c806308386eba146100445780637b1039991461008b578063b61d27f6146100d757600080fd5b3661003f57005b600080fd5b34801561005057600080fd5b506100787f000000000000000000000000000000000000000000000000000000000000000081565b6040519081526020015b60405180910390f35b34801561009757600080fd5b506100bf7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b039091168152602001610082565b3480156100e357600080fd5b506100f76100f23660046102e4565b610104565b60405161008291906103e1565b6040517f39b86b8c0000000000000000000000000000000000000000000000000000000081527f000000000000000000000000000000000000000000000000000000000000000060048201523360248201526060907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906339b86b8c90604401602060405180830381865afa1580156101aa573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101ce9190610414565b610204576040517f075fd2b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001600160a01b03841661022b576040516384aed38d60e01b815260040160405180910390fd5b600080856001600160a01b03168585604051610247919061043d565b60006040518083038185875af1925050503d8060008114610284576040519150601f19603f3d011682016040523d82523d6000602084013e610289565b606091505b5091509150816102ac576040516384aed38d60e01b815260040160405180910390fd5b95945050505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000806000606084860312156102f957600080fd5b83356001600160a01b038116811461031057600080fd5b925060208401359150604084013567ffffffffffffffff8082111561033457600080fd5b818601915086601f83011261034857600080fd5b81358181111561035a5761035a6102b5565b604051601f8201601f19908116603f01168101908382118183101715610382576103826102b5565b8160405282815289602084870101111561039b57600080fd5b8260208601602083013760006020848301015280955050505050509250925092565b60005b838110156103d85781810151838201526020016103c0565b50506000910152565b60208152600082518060208401526104008160408501602087016103bd565b601f01601f19169190910160400192915050565b60006020828403121561042657600080fd5b8151801515811461043657600080fd5b9392505050565b6000825161044f8184602087016103bd565b919091019291505056fea2646970667358221220375011294c23621c2a0fae542d6b13301a64a78e0f2bb4f12bb1558964a7f4d364736f6c63430008130033b3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182)
    │   │   ├─ [233889] → new Anchor@0xE4C662c4b8018EEA89294209Cd34Efb150EF4297
    │   │   │   └─ ← 1167 bytes of code
    │   │   └─ ← ()
    │   ├─ emit RoleGranted(role: 0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, account: pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107], sender: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   ├─ emit RoleGranted(role: 0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, account: pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f], sender: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   ├─ emit ProfileCreated(profileId: 0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, nonce: 0, name: Pool Profile 1, metadata: (1, PoolProfile1), owner: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], anchor: Anchor: [0xE4C662c4b8018EEA89294209Cd34Efb150EF4297])
    │   └─ ← 0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182
    ├─ [3776] Registry::getProfileById(0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182) [staticcall]
    │   └─ ← (0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, 0, Pool Profile 1, (1, PoolProfile1), 0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019, 0xE4C662c4b8018EEA89294209Cd34Efb150EF4297)
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d]
    ├─ [0] VM::label(profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d], profile1_owner)
    │   └─ ← ()
    ├─ [0] VM::prank(profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d]
    ├─ [0] VM::label(profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d], profile1_owner)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile1_member1: [0x32AA463a3F1fc42AbEAD98584E6A73826124B214]
    ├─ [0] VM::label(profile1_member1: [0x32AA463a3F1fc42AbEAD98584E6A73826124B214], profile1_member1)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile1_member2: [0x1ed2CE7e57A08c9a31c35782c6016318f2B53150]
    ├─ [0] VM::label(profile1_member2: [0x1ed2CE7e57A08c9a31c35782c6016318f2B53150], profile1_member2)
    │   └─ ← ()
    ├─ [522450] Registry::createProfile(0, Profile 1, (1, Profile1), profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d], [0x32AA463a3F1fc42AbEAD98584E6A73826124B214, 0x1ed2CE7e57A08c9a31c35782c6016318f2B53150])
    │   ├─ [1617] → new <Unknown>@0x8411887dF1099B97792398f36630a770e062C779
    │   │   └─ ← 8 bytes of code
    │   ├─ [266159] 0x8411887dF1099B97792398f36630a770e062C779::60c06040(5234801561001057600080fd5b5060405161051438038061051483398101604081905261002f9161003b565b3360805260a052610054565b60006020828403121561004d57600080fd5b5051919050565b60805160a05161048f610085600039600081816056015261012c015260008181609d015261015b015261048f6000f3fe6080604052600436106100385760003560e01c806308386eba146100445780637b1039991461008b578063b61d27f6146100d757600080fd5b3661003f57005b600080fd5b34801561005057600080fd5b506100787f000000000000000000000000000000000000000000000000000000000000000081565b6040519081526020015b60405180910390f35b34801561009757600080fd5b506100bf7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b039091168152602001610082565b3480156100e357600080fd5b506100f76100f23660046102e4565b610104565b60405161008291906103e1565b6040517f39b86b8c0000000000000000000000000000000000000000000000000000000081527f000000000000000000000000000000000000000000000000000000000000000060048201523360248201526060907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906339b86b8c90604401602060405180830381865afa1580156101aa573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101ce9190610414565b610204576040517f075fd2b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001600160a01b03841661022b576040516384aed38d60e01b815260040160405180910390fd5b600080856001600160a01b03168585604051610247919061043d565b60006040518083038185875af1925050503d8060008114610284576040519150601f19603f3d011682016040523d82523d6000602084013e610289565b606091505b5091509150816102ac576040516384aed38d60e01b815260040160405180910390fd5b95945050505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000806000606084860312156102f957600080fd5b83356001600160a01b038116811461031057600080fd5b925060208401359150604084013567ffffffffffffffff8082111561033457600080fd5b818601915086601f83011261034857600080fd5b81358181111561035a5761035a6102b5565b604051601f8201601f19908116603f01168101908382118183101715610382576103826102b5565b8160405282815289602084870101111561039b57600080fd5b8260208601602083013760006020848301015280955050505050509250925092565b60005b838110156103d85781810151838201526020016103c0565b50506000910152565b60208152600082518060208401526104008160408501602087016103bd565b601f01601f19169190910160400192915050565b60006020828403121561042657600080fd5b8151801515811461043657600080fd5b9392505050565b6000825161044f8184602087016103bd565b919091019291505056fea2646970667358221220375011294c23621c2a0fae542d6b13301a64a78e0f2bb4f12bb1558964a7f4d364736f6c6343000813003341ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909)
    │   │   ├─ [233889] → new Anchor@0xad5FDFa74961f0b6F1745eF0A1Fa0e115caa9641
    │   │   │   └─ ← 1167 bytes of code
    │   │   └─ ← ()
    │   ├─ emit RoleGranted(role: 0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909, account: profile1_member1: [0x32AA463a3F1fc42AbEAD98584E6A73826124B214], sender: profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d])
    │   ├─ emit RoleGranted(role: 0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909, account: profile1_member2: [0x1ed2CE7e57A08c9a31c35782c6016318f2B53150], sender: profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d])
    │   ├─ emit ProfileCreated(profileId: 0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909, nonce: 0, name: Profile 1, metadata: (1, Profile1), owner: profile1_owner: [0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d], anchor: Anchor: [0xad5FDFa74961f0b6F1745eF0A1Fa0e115caa9641])
    │   └─ ← 0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909
    ├─ [3776] Registry::getProfileById(0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909) [staticcall]
    │   └─ ← (0x41ec40bff45a0ff7c9640ced2800f5352e17799050e200428364114ac24b1909, 0, Profile 1, (1, Profile1), 0x2D888D2e39caeb77649Bd81D64d23C4Bf023eb5d, 0xad5FDFa74961f0b6F1745eF0A1Fa0e115caa9641)
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c]
    ├─ [0] VM::label(profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c], profile2_owner)
    │   └─ ← ()
    ├─ [0] VM::prank(profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c]
    ├─ [0] VM::label(profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c], profile2_owner)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile2_member1: [0xc358bff6431Cf2E90ce3EF4e18871Ca4bBe459e2]
    ├─ [0] VM::label(profile2_member1: [0xc358bff6431Cf2E90ce3EF4e18871Ca4bBe459e2], profile2_member1)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← profile2_member2: [0x4E9320E333F3DDbc20f51d7fe87C3857a4aeDa41]
    ├─ [0] VM::label(profile2_member2: [0x4E9320E333F3DDbc20f51d7fe87C3857a4aeDa41], profile2_member2)
    │   └─ ← ()
    ├─ [522450] Registry::createProfile(0, Profile 2, (1, Profile2), profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c], [0xc358bff6431Cf2E90ce3EF4e18871Ca4bBe459e2, 0x4E9320E333F3DDbc20f51d7fe87C3857a4aeDa41])
    │   ├─ [1617] → new <Unknown>@0xEb8BeBB84a881f71509e868DD3877035f72b8fC2
    │   │   └─ ← 8 bytes of code
    │   ├─ [266159] 0xEb8BeBB84a881f71509e868DD3877035f72b8fC2::60c06040(5234801561001057600080fd5b5060405161051438038061051483398101604081905261002f9161003b565b3360805260a052610054565b60006020828403121561004d57600080fd5b5051919050565b60805160a05161048f610085600039600081816056015261012c015260008181609d015261015b015261048f6000f3fe6080604052600436106100385760003560e01c806308386eba146100445780637b1039991461008b578063b61d27f6146100d757600080fd5b3661003f57005b600080fd5b34801561005057600080fd5b506100787f000000000000000000000000000000000000000000000000000000000000000081565b6040519081526020015b60405180910390f35b34801561009757600080fd5b506100bf7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b039091168152602001610082565b3480156100e357600080fd5b506100f76100f23660046102e4565b610104565b60405161008291906103e1565b6040517f39b86b8c0000000000000000000000000000000000000000000000000000000081527f000000000000000000000000000000000000000000000000000000000000000060048201523360248201526060907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906339b86b8c90604401602060405180830381865afa1580156101aa573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101ce9190610414565b610204576040517f075fd2b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001600160a01b03841661022b576040516384aed38d60e01b815260040160405180910390fd5b600080856001600160a01b03168585604051610247919061043d565b60006040518083038185875af1925050503d8060008114610284576040519150601f19603f3d011682016040523d82523d6000602084013e610289565b606091505b5091509150816102ac576040516384aed38d60e01b815260040160405180910390fd5b95945050505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000806000606084860312156102f957600080fd5b83356001600160a01b038116811461031057600080fd5b925060208401359150604084013567ffffffffffffffff8082111561033457600080fd5b818601915086601f83011261034857600080fd5b81358181111561035a5761035a6102b5565b604051601f8201601f19908116603f01168101908382118183101715610382576103826102b5565b8160405282815289602084870101111561039b57600080fd5b8260208601602083013760006020848301015280955050505050509250925092565b60005b838110156103d85781810151838201526020016103c0565b50506000910152565b60208152600082518060208401526104008160408501602087016103bd565b601f01601f19169190910160400192915050565b60006020828403121561042657600080fd5b8151801515811461043657600080fd5b9392505050565b6000825161044f8184602087016103bd565b919091019291505056fea2646970667358221220375011294c23621c2a0fae542d6b13301a64a78e0f2bb4f12bb1558964a7f4d364736f6c63430008130033ce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4)
    │   │   ├─ [233889] → new Anchor@0x4E0aB029b2128e740fA408a26aC5f314e769469f
    │   │   │   └─ ← 1167 bytes of code
    │   │   └─ ← ()
    │   ├─ emit RoleGranted(role: 0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4, account: profile2_member1: [0xc358bff6431Cf2E90ce3EF4e18871Ca4bBe459e2], sender: profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c])
    │   ├─ emit RoleGranted(role: 0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4, account: profile2_member2: [0x4E9320E333F3DDbc20f51d7fe87C3857a4aeDa41], sender: profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c])
    │   ├─ emit ProfileCreated(profileId: 0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4, nonce: 0, name: Profile 2, metadata: (1, Profile2), owner: profile2_owner: [0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c], anchor: Anchor: [0x4E0aB029b2128e740fA408a26aC5f314e769469f])
    │   └─ ← 0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4
    ├─ [3776] Registry::getProfileById(0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4) [staticcall]
    │   └─ ← (0xce6ccaa269c65528ca658852ba7db8f27381e06b52e4b77db17c9a1475b22bc4, 0, Profile 2, (1, Profile2), 0x3ed73A046b5BF6C7E4F8c4733d4d3Be3e311A43c, 0x4E0aB029b2128e740fA408a26aC5f314e769469f)
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481]
    ├─ [0] VM::label(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], allo_owner)
    │   └─ ← ()
    ├─ [0] VM::startPrank(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481])
    │   └─ ← ()
    ├─ [2720553] → new Allo@0x9b40E73C1070fD77cFc3594A84E349C86E6F721f
    │   └─ ← 13588 bytes of code
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← allo_treasury: [0x11CDD8c4b40352E593942e66b1ccA5DC28E391B4]
    ├─ [0] VM::label(allo_treasury: [0x11CDD8c4b40352E593942e66b1ccA5DC28E391B4], allo_treasury)
    │   └─ ← ()
    ├─ [120967] Allo::initialize(Registry: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f], allo_treasury: [0x11CDD8c4b40352E593942e66b1ccA5DC28E391B4], 10000000000000000 [1e16], 0)
    │   ├─ emit OwnershipTransferred(oldOwner: 0x0000000000000000000000000000000000000000, newOwner: allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481])
    │   ├─ emit RegistryUpdated(registry: Registry: [0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f])
    │   ├─ emit TreasuryUpdated(treasury: allo_treasury: [0x11CDD8c4b40352E593942e66b1ccA5DC28E391B4])
    │   ├─ emit PercentFeeUpdated(percentFee: 10000000000000000 [1e16])
    │   ├─ emit BaseFeeUpdated(baseFee: 0)
    │   ├─ emit Initialized(version: 1)
    │   └─ ← ()
    ├─ [0] VM::stopPrank()
    │   └─ ← ()
    ├─ [702732] → new MockERC20@0x2e234DAe75C793f67A35089C9d99245E1C58470b
    │   └─ ← 3174 bytes of code
    ├─ [46581] MockERC20::mint(AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], 1000000000000000000000000 [1e24])
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], amount: 1000000000000000000000000 [1e24])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481]
    ├─ [0] VM::label(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], allo_owner)
    │   └─ ← ()
    ├─ [24681] MockERC20::mint(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], 1000000000000000000000000 [1e24])        
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], amount: 1000000000000000000000000 [1e24])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]
    ├─ [0] VM::label(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], pool_admin)
    │   └─ ← ()
    ├─ [24681] MockERC20::mint(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], 1000000000000000000000000 [1e24])        
    │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], amount: 1000000000000000000000000 [1e24])
    │   └─ ← ()
    ├─ [24403] MockERC20::approve(Allo: [0x9b40E73C1070fD77cFc3594A84E349C86E6F721f], 1000000000000000000000000 [1e24])
    │   ├─ emit Approval(owner: AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496], spender: Allo: [0x9b40E73C1070fD77cFc3594A84E349C86E6F721f], amount: 1000000000000000000000000 [1e24])
    │   └─ ← true
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]
    ├─ [0] VM::label(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], pool_admin)
    │   └─ ← ()
    ├─ [0] VM::prank(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   └─ ← ()
    ├─ [24403] MockERC20::approve(Allo: [0x9b40E73C1070fD77cFc3594A84E349C86E6F721f], 1000000000000000000000000 [1e24])
    │   ├─ emit Approval(owner: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], spender: Allo: [0x9b40E73C1070fD77cFc3594A84E349C86E6F721f], amount: 1000000000000000000000000 [1e24])
    │   └─ ← true
    ├─ [678020] → new <Unknown>@0xF62849F9A0B5Bf2913b396098F7c7019b51A820a
    │   └─ ← 3383 bytes of code
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481]
    ├─ [0] VM::label(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], allo_owner)
    │   └─ ← ()
    ├─ [0] VM::startPrank(allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481])
    │   └─ ← ()
    ├─ [2335] Allo::transferOwnership(AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   ├─ emit OwnershipTransferred(oldOwner: allo_owner: [0xCcfcDE8541cC00E87CF7Ad08A9364f157964e481], newOwner: AlloTest: [0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496])
    │   └─ ← ()
    ├─ [0] VM::stopPrank()
    │   └─ ← ()
    └─ ← ()

  [458555] AlloTest::test_UserWillNeverBeAbleToFundThePoolIfPercentFeeIsOneHundredPercent()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]
    ├─ [0] VM::label(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], pool_admin)
    │   └─ ← ()
    ├─ [0] VM::prank(pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107]
    ├─ [0] VM::label(pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107], pool_manager1)
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f]
    ├─ [0] VM::label(pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f], pool_manager2)
    │   └─ ← ()
    ├─ [326374] Allo::createPoolWithCustomStrategy(0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a, 0x3078, 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE, 0, (1, strategy pointer), [0x05800FAD118693c398e4E1ceFBb1FAC54537b107, 0xF49D32655a289163297342376EA91F6434cff60f])
    │   ├─ [2696] Registry::isOwnerOrMemberOfProfile(0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019]) [staticcall]
    │   │   └─ ← true
    │   ├─ emit RoleGranted(role: 0xd866368887d58dbdd097c420fb7ec3bf9a28071e2c715e21155ba472632c67b1, account: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019], sender: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   ├─ emit RoleAdminChanged(role: 0x0000000000000000000000000000000000000000000000000000000000000001, previousAdminRole: 0x0000000000000000000000000000000000000000000000000000000000000000, newAdminRole: 0xd866368887d58dbdd097c420fb7ec3bf9a28071e2c715e21155ba472632c67b1)
    │   ├─ [0] console::9710a9d0(00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002d53656e64696e6720257320746f2074686520737472617465677920666f7220696e697469616c697a6174696f6e00000000000000000000000000000000000000) [staticcall]
    │   │   └─ ← ()
    │   ├─ [23870] 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a::initialize(1, 0x3078)
    │   │   ├─ [0] console::9710a9d0(0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000186465706c6f79696e67207769746820706f6f6c49642025730000000000000000) [staticcall]
    │   │   │   └─ ← ()
    │   │   ├─ [0] console::f5b1bba9(0000000000000000000000000000000000000000000000000000000000000001) [staticcall]
    │   │   │   └─ ← ()
    │   │   └─ ← ()
    │   ├─ [304] 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a::getPoolId() [staticcall]
    │   │   └─ ← 0x0000000000000000000000000000000000000000000000000000000000000001
    │   ├─ [237] 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a::getAllo() [staticcall]
    │   │   └─ ← 0x0000000000000000000000009b40e73c1070fd77cfc3594a84e349c86e6f721f
    │   ├─ emit RoleGranted(role: 0x0000000000000000000000000000000000000000000000000000000000000001, account: pool_manager1: [0x05800FAD118693c398e4E1ceFBb1FAC54537b107], sender: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   ├─ emit RoleGranted(role: 0x0000000000000000000000000000000000000000000000000000000000000001, account: pool_manager2: [0xF49D32655a289163297342376EA91F6434cff60f], sender: pool_admin: [0x6E1FEb7a47a8A2C71E61BA8e3c4D5243CB392019])
    │   ├─ emit PoolCreated(poolId: 1, profileId: 0xb3c8f868e0a570b26fec0dcc52d639611aeb5fe816154b3054f3eb4402def182, strategy: 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a, token: 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE, amount: 0, metadata: (1, strategy pointer))
    │   └─ ← 1
    ├─ [23569] Allo::updateBaseFee(1000000000000000000 [1e18])
    │   ├─ emit BaseFeeUpdated(baseFee: 1000000000000000000 [1e18])
    │   └─ ← ()
    ├─ [6593] Allo::updatePercentFee(1000000000000000000 [1e18])
    │   ├─ emit PercentFeeUpdated(percentFee: 1000000000000000000 [1e18])
    │   └─ ← ()
    ├─ [0] VM::addr(<pk>) [staticcall]
    │   └─ ← user: [0x6CA6d1e2D5347Bfab1d91e883F1915560e09129D]
    ├─ [0] VM::label(user: [0x6CA6d1e2D5347Bfab1d91e883F1915560e09129D], user)
    │   └─ ← ()
    ├─ [0] VM::deal(user: [0x6CA6d1e2D5347Bfab1d91e883F1915560e09129D], 4000000000000000000 [4e18])
    │   └─ ← ()
    ├─ [0] VM::prank(user: [0x6CA6d1e2D5347Bfab1d91e883F1915560e09129D])
    │   └─ ← ()
    ├─ [67024] Allo::fundPool{value: 3000000000000010000}(1, 2000000000000000000 [2e18])
    │   ├─ [0] console::e3849f79(00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000001bc16d674ec8000000000000000000000000000011cdd8c4b40352e593942e66b1cca5dc28e391b400000000000000000000000000000000000000000000000000000000000000145472616e73666572696e6720257320746f202573000000000000000000000000) [staticcall]
    │   │   └─ ← ()
    │   ├─ [0] allo_treasury::fallback{value: 2000000000000000000}()
    │   │   └─ ← ()
    │   ├─ [0] console::e3849f79(00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f62849f9a0b5bf2913b396098f7c7019b51a820a00000000000000000000000000000000000000000000000000000000000000145472616e73666572696e6720257320746f202573000000000000000000000000) [staticcall]
    │   │   └─ ← ()
    │   ├─ [40] 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a::fallback()
    │   │   └─ ← ()
    │   ├─ [2707] 0xF62849F9A0B5Bf2913b396098F7c7019b51A820a::increasePoolAmount(0)
    │   │   └─ ← ()
    │   ├─ emit PoolFunded(poolId: 1, amount: 0, fee: 2000000000000000000 [2e18])
    │   └─ ← ()
    └─ ← ()

Test result: ok. 1 passed; 0 failed; 0 skipped; finished in 8.14ms

Ran 1 test suites: 1 tests passed, 0 failed, 0 skipped (1 total tests)
```


</details>


## Tool used

Manual Review

## Recommendation
There are two way to solve this:
1. Add fix fee
2. Add a `maxFee` variable for the percentFee and make sure that necessary checks are done in `_updatePercentFee` function for checking that.

For example: 
```diff
    function _updatePercentFee(uint256 _percentFee) internal {
-      if (_percentFee > 1e18 ) revert INVALID_FEE();
- 
+        if (_percentFee > 1e18 || maxFee < _percentFee) revert INVALID_FEE();
        percentFee = _percentFee;

        emit PercentFeeUpdated(percentFee);
    }
```
